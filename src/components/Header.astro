---
const nav = [
  { name: "Start", href: "/" },
  {
    name: "Leistungen", href: "#", sub: [
      { name: "Website-Pflege & Wartung", href: "/website-pflege" },
      { name: "SEO / SEA", href: "/seo-sea" },
      { name: "IT-Beratung & KI", href: "/it-beratung" },
      { name: "Technik-Support", href: "/technik-support" },
      { name: "Smartphone-Hilfe", href: "/smartphone-hilfe" },
      { name: "Digitalisierung", href: "/digitalisierung" }
    ]
  },
  { name: "Über uns", href: "/ueber-uns" },
  { name: "Lernplattform", href: "/lernplattform" },
  { name: "Tools", href: "/tools" },
  { name: "Kontakt", href: "/kontakt" }
];
const googleReviewLink = "https://g.page/r/CVh6_BBXMl3vEAI/review";
import { withVersion } from '../utils/version.ts';
---

<header id="site-header" class="fixed inset-x-0 top-0 z-50 bg-dark text-white transition-colors duration-300 shadow-lg h-20">
  <div class="max-w-7xl mx-auto flex items-center justify-between px-6 h-20">
    <a href={googleReviewLink} target="_blank" rel="noopener" class="hidden md:inline-block font-semibold tracking-wide text-gold px-4 py-2 whitespace-nowrap" aria-label="Jetzt bewerten">
      Bewerte uns
    </a>

    <button id="menu-toggle" class="md:hidden text-gold focus:outline-none z-[80] transition-transform duration-200" aria-label="Menü öffnen" aria-expanded="false" type="button">
      <svg id="burger-x" class="w-10 h-10" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="3" aria-hidden="true">
        <path id="line1" stroke-linecap="round" stroke-linejoin="round" d="M8 10h16" />
        <path id="line2" stroke-linecap="round" stroke-linejoin="round" d="M8 16h16" />
        <path id="line3" stroke-linecap="round" stroke-linejoin="round" d="M8 22h16" />
      </svg>
    </button>

    <!-- Desktop-Navigation -->
    <nav class="hidden md:flex gap-6 items-center mx-auto w-full justify-center relative">
      {nav.map(item =>
        !item.sub ? (
          <a href={item.href} class="hover:text-gold transition font-medium px-3 py-1 rounded focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2">{item.name}</a>
        ) : (
          <div class="relative group/nav" tabindex="-1">
            <button type="button" class="hover:text-gold transition font-medium px-3 py-1 rounded flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2" aria-haspopup="true" aria-expanded="false">
              {item.name}
              <svg class="w-3 h-3 ml-1" fill="currentColor" viewBox="0 0 20 20"><path d="M5.5 8.5l4.5 4 4.5-4"/></svg>
            </button>
            <div class="absolute left-0 top-full w-full h-3"></div>
            <div class="absolute left-0 top-full mt-2 min-w-[240px] bg-white text-dark shadow-xl rounded-lg opacity-0 pointer-events-none transition-all duration-150 z-[60]
                        group-hover/nav:opacity-100 group-hover/nav:pointer-events-auto
                        focus-within:opacity-100 focus-within:pointer-events-auto">
              {item.sub.map(sub => <a href={sub.href} class="block px-5 py-3 text-sm font-medium hover:bg-gold/10 hover:text-gold rounded-lg transition-all">{sub.name}</a>)}
            </div>
          </div>
        )
      )}
    </nav>
  </div>

  <!-- Mobile Navigation -->
  <nav id="mobile-menu" class="fixed inset-0 z-[70] md:hidden opacity-0 pointer-events-none transition-opacity duration-300 bg-dark" aria-hidden="true">
    <div id="mobile-panel" class="relative h-full w-full max-w-[92%] sm:max-w-[420px] bg-dark text-white shadow-2xl translate-x-[-100%] transition-transform duration-300">
      
      <!-- Inhalt -->
      <div class="h-full overflow-y-auto flex flex-col items-center text-center pt-24 pb-[env(safe-area-inset-bottom)] px-6">
        <div class="w-full max-w-xs space-y-2">
          {nav.map(item =>
            !item.sub ? (
              <a href={item.href} class="block w-full px-4 py-3 text-[1.375rem] leading-tight font-extrabold tracking-tight rounded-lg hover:bg-white/5 focus:bg-white/10">
                {item.name}
              </a>
            ) : (
              <details class="group">
                <summary class="list-none w-full px-4 py-3 text-[1.375rem] leading-tight font-extrabold tracking-tight rounded-lg hover:bg-white/5 focus:bg-white/10 cursor-pointer inline-flex items-center justify-center gap-2">
                  {item.name}
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5.5 8.5l4.5 4 4.5-4"/></svg>
                </summary>
                <div class="mt-1 space-y-1">
                  {item.sub.map(sub =>
                    <a href={sub.href} class="block w-full px-4 py-2 text-lg font-medium text-gold rounded hover:bg-gold/10">
                      {sub.name}
                    </a>
                  )}
                </div>
              </details>
            )
          )}
        </div>

        <!-- CTA -->
        <div class="w-full max-w-xs mt-8">
          <a href={googleReviewLink} target="_blank" rel="noopener"
             class="block w-full text-center bg-gold text-dark py-4 px-6 rounded-2xl text-lg font-bold shadow-lg hover:opacity-90 transition">
            Bewerte uns
          </a>
        </div>

        <div class="h-8"></div>
      </div>
    </div>
  </nav>

  <script type="module" src={withVersion('/scripts/header.js')} defer></script>
</header>